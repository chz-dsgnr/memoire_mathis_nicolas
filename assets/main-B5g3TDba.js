(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))f(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const b of o.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&f(b)}).observe(document,{childList:!0,subtree:!0});function p(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function f(l){if(l.ep)return;l.ep=!0;const o=p(l);fetch(l.href,o)}})();particlesJS.load("particles-js","/particles.json",function(){console.log("particles.js config loaded")});gsap.registerPlugin(SplitText);console.clear();document.fonts.ready.then(()=>{gsap.set(".split",{opacity:1});let y;SplitText.create(".split",{type:"words,lines",linesClass:"line",autoSplit:!0,mask:"lines",onSplit:i=>(y=gsap.from(i.lines,{duration:2,yPercent:100,opacity:0,stagger:.1,ease:"expo.out"}),y)}),document.querySelector("button").addEventListener("click",i=>{y.timeScale(.2).play(0)})});gsap.registerPlugin(SplitText);console.clear();document.fonts.ready.then(()=>{gsap.set(".split2",{opacity:1});let y;SplitText.create(".split2",{type:"words,lines",linesClass:"line",autoSplit:!0,mask:"lines",onSplit:i=>(y=gsap.from(i.lines,{duration:3,yPercent:100,opacity:0,stagger:.1,ease:"expo.out"}),y)}),document.querySelector("button").addEventListener("click",i=>{split.timeScale(.2).play(0)})});document.addEventListener("DOMContentLoaded",()=>{const y=document.querySelectorAll(".sommaire .block-somm"),i=document.querySelector(".sommaire"),p=parseInt(i?.dataset.offset??64,10);y.forEach(f=>{const l=()=>{const o=f.dataset.target,b=o?document.querySelector(o):null;if(!b)return;const w=f.dataset.offset?parseInt(f.dataset.offset,10):p,E=(b.querySelector("h1, h2, h3, h4, h5, h6")||b).getBoundingClientRect().top+window.scrollY-w;window.scrollTo({top:E,behavior:"smooth"});try{history.replaceState(null,"",o)}catch{}};f.addEventListener("click",l),f.addEventListener("keydown",o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),l())})})});document.addEventListener("DOMContentLoaded",()=>{const y=document.querySelector(".footnotes");y&&(y.style.display="none");const i=document.createElement("div");i.className="footnote-popup",i.hidden=!0,document.body.appendChild(i);const p=document.createElement("div");p.className="footnote-popup-content",i.appendChild(p);const f=document.createElement("button");f.className="footnote-close",f.innerHTML="&times;",f.setAttribute("aria-label","Fermer"),p.appendChild(f);const l=document.createElement("div");l.className="footnote-note",p.appendChild(l);const o=new Map;document.querySelectorAll(".footnotes ol li").forEach(g=>{o.set(g.id,g.innerHTML)});const b=g=>{const E=o.get(g);E&&(l.innerHTML=E,i.hidden=!1)},w=()=>{i.hidden=!0};document.querySelectorAll(".footnote-ref").forEach(g=>{g.addEventListener("click",E=>{E.preventDefault();const C=g.getAttribute("href").replace("#","");b(C)})}),f.addEventListener("click",g=>{g.stopPropagation(),w()}),i.addEventListener("click",g=>{g.target===i&&w()}),document.addEventListener("keydown",g=>{g.key==="Escape"&&!i.hidden&&w()})});document.addEventListener("DOMContentLoaded",()=>{const i=document.getElementById("swiper-modal"),p=i?.querySelector(".swiper-wrapper"),f=i?.querySelector(".close-media"),l=i?.querySelector(".media-count-overlay");let o=null;const b=()=>window.matchMedia("(max-width: 1200px)").matches;function w(e){const r=Array.from(e.querySelectorAll("img, video")),s=[];function n(t){const a=t.match(/\/embed\/([^?&]+)/);if(a)return a[1];const d=t.match(/youtu\.be\/([^?&]+)/);if(d)return d[1];const c=t.match(/[?&]v=([^?&]+)/);return c?c[1]:null}return r.forEach(t=>{const d=t.tagName.toLowerCase()==="video"?t.getAttribute("data-embed"):null;if(d){const m=n(d);if(m){const v=document.createElement("img");v.src=`https://img.youtube.com/vi/${m}/hqdefault.jpg`,v.alt=t.getAttribute("data-caption")||"Vid√©o",v.className="embed-preview",v.setAttribute("data-embed",d),t.parentNode.replaceChild(v,t),t=v}}let c=t.closest("figure");c?c.classList.add("mm-item"):(c=document.createElement("figure"),c.className="mm-item",t.parentNode.insertBefore(c,t),c.appendChild(t));const u=t.tagName.toLowerCase()==="video",h=u?t.getAttribute("data-caption")||"":t.getAttribute("alt")||"";let S=c.querySelector("figcaption");!S&&h&&(S=document.createElement("figcaption"),S.textContent=h,c.appendChild(S)),u&&(t.setAttribute("playsinline",""),t.muted=!0,t.loop=!0,t.autoplay=!1),s.push(c)}),s}function g(e){if(e._anchor)return e._anchor;const r=document.createElement("span");return r.className="margin-anchor",r.setAttribute("aria-hidden","true"),e.parentNode.insertBefore(r,e),e._anchor=r,e._origParent=r.parentNode,r}function E(e){return e.closest(".text-mem, .level2, .level1, #memoire")||document.body}function A(e){const r=g(e),s=E(e);if(b()){e.parentNode!==r.parentNode&&r.parentNode.insertBefore(e,r.nextSibling),e.style.position="static",e.style.top="",e.style.left="",e.style.right="",e.style.width="";return}e.parentNode!==s&&s.appendChild(e);const n=r.getBoundingClientRect(),t=s.getBoundingClientRect();let a=n.top-t.top;const d=parseFloat(e.getAttribute("data-offset-top")||"0");a+=isNaN(d)?0:d,e.style.position="absolute",e.style.top=`${Math.round(a)}px`;const c=e.getAttribute("data-left"),u=e.getAttribute("data-right"),h=e.getAttribute("data-width");c!==null&&(e.style.left=c,e.style.right=""),u!==null&&(e.style.right=u,e.style.left=""),h&&(e.style.width=h)}function C(e,r=""){const s=document.createElement("div");s.className="swiper-slide";const n=document.createElement("iframe");if(n.src=e,n.dataset.src=e,n.className="embed-frame",n.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture; fullscreen",n.allowFullscreen=!0,n.frameBorder="0",n.style.width="100vw",n.style.height="100vh",n.style.objectFit="cover",s.appendChild(n),r){const t=document.createElement("figcaption");t.textContent=r,s.appendChild(t)}return s}function L(e){const r=i.querySelector(".swiper-button-prev"),s=i.querySelector(".swiper-button-next");!r||!s||(e<2?(r.style.display="none",s.style.display="none"):(r.style.display="",s.style.display=""))}function T(e,r=0){if(!i||!p)return;p.innerHTML="";const s=Array.from(e.querySelectorAll("img, video"));s.forEach(c=>{const u=c.getAttribute("data-embed");if(u){const m=c.getAttribute("data-caption")||c.getAttribute("alt")||"";p.appendChild(C(u,m));return}const h=document.createElement("div");if(h.className="swiper-slide",c.tagName.toLowerCase()==="video"){const m=document.createElement("video");m.src=c.currentSrc||c.src,m.controls=!0,m.muted=!1,m.setAttribute("playsinline",""),m.autoplay=!0,h.appendChild(m);const v=c.getAttribute("data-caption")||"";if(v){const k=document.createElement("figcaption");k.textContent=v,h.appendChild(k)}}else{const m=document.createElement("img");if(m.src=c.currentSrc||c.src,m.alt=c.alt||"",h.appendChild(m),c.alt){const v=document.createElement("figcaption");v.textContent=c.alt,h.appendChild(v)}}p.appendChild(h)}),i.hidden=!1;const n=p.children.length,t=s[0],a=n===1&&t&&t.tagName.toLowerCase()==="video"&&!t.getAttribute("data-embed");o&&(o.destroy(!0,!0),o=null);const d=i.querySelector(".swiper");if(o=new Swiper(d,{initialSlide:Math.min(r,n-1),loop:!a&&n>1,slidesPerView:1,keyboard:{enabled:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),L(n),l){l.dataset.active=n>1?"1":"0";const c=()=>{const u=(o.realIndex??o.activeIndex)+1;l.textContent=`${u}/${n}`};o.on("slideChange",c),c()}}function N(){i&&(i.querySelectorAll("video").forEach(e=>{try{e.pause(),e.currentTime=0}catch{}}),i.querySelectorAll("iframe.embed-frame").forEach(e=>{try{e.contentWindow?.postMessage('{"event":"command","func":"stopVideo","args":""}',"*")}catch{}e.dataset.src,e.setAttribute("src","about:blank")}),i.hidden=!0,o&&(o.destroy(!0,!0),o=null),p.innerHTML="")}function P(e,r=0){if(!i||!p)return;p.innerHTML="",Array.from(e.querySelectorAll("figure")).forEach(t=>{const a=t.querySelector("img,video,iframe");if(!a)return;const d=document.createElement("div");if(d.className="swiper-slide",a.tagName.toLowerCase()==="video"){const u=document.createElement("video");u.src=a.currentSrc||a.src,u.controls=!0,u.autoplay=!0,u.setAttribute("playsinline",""),d.appendChild(u)}else if(a.tagName.toLowerCase()==="img"){const u=document.createElement("img");u.src=a.currentSrc||a.src,u.alt=a.alt||"",d.appendChild(u)}else a.tagName.toLowerCase()==="iframe"&&d.appendChild(a.cloneNode(!0));const c=t.querySelector("figcaption");if(c){const u=document.createElement("figcaption");u.textContent=c.textContent,d.appendChild(u)}p.appendChild(d)}),i.hidden=!1;const n=p.children.length;if(o&&(o.destroy(!0,!0),o=null),o=new Swiper(i.querySelector(".swiper"),{initialSlide:Math.min(r,n-1),loop:n>1,slidesPerView:1,keyboard:{enabled:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),L(n),l){l.dataset.active=n>1?"1":"0";const t=()=>{const a=(o.realIndex??o.activeIndex)+1;l.textContent=`${a}/${n}`};o.on("slideChange",t),t()}}function B(){Array.from(document.querySelectorAll(".margin-media[data-target], .margin-gallery[data-target], img.margin-media[data-target], video.margin-media[data-target]")).forEach(r=>{let s=r.getAttribute("data-target");if(!s)return;/^([#.\[])/.test(s)||(s="#"+s.replace(/\s+/g,"").toLowerCase());const n=document.querySelector(s);if(!n)return;if((r.tagName==="IMG"||r.tagName==="VIDEO")&&!r.classList.contains("processed-single")){const a=document.createElement("div");a.className="margin-media",Array.from(r.attributes).forEach(d=>{(d.name.startsWith("data-")||d.name==="class")&&a.setAttribute(d.name,d.value)}),r.classList.remove("margin-media"),a.appendChild(r),r.parentNode.insertBefore(a,r),r=a,r.classList.add("processed-single")}const t=r.getAttribute("data-insert")||"after";if(t==="after-heading"){const a=n.querySelector("h1,h2,h3,h4,h5,h6");if(a&&a.parentNode){a.parentNode.insertBefore(r,a.nextSibling);return}}switch(t){case"before":n.parentNode.insertBefore(r,n);break;case"append":n.appendChild(r);break;case"replace":n.parentNode.insertBefore(r,n),n.remove();break;case"after":default:n.parentNode.insertBefore(r,n.nextSibling);break}}),document.querySelectorAll(".margin-gallery figure[data-src]").forEach(r=>{if(r.dataset.processed)return;const s=r.getAttribute("data-src"),n=r.getAttribute("data-caption")||"";if(/\.(mp4|webm|ogg)$/i.test(s)){const t=document.createElement("video");t.src=s,t.muted=!0,t.playsInline=!0,t.loop=!0,t.autoplay=!0,r.appendChild(t)}else{const t=document.createElement("img");t.src=s,t.alt=n,r.appendChild(t)}if(n){const t=document.createElement("figcaption");t.textContent=n,r.appendChild(t)}r.dataset.processed="1"}),document.querySelectorAll(".margin-gallery").forEach(r=>{Array.from(r.querySelectorAll("figure")).forEach((n,t)=>{const a=n.querySelector("img, video");a&&(a.style.cursor="pointer",a.addEventListener("click",d=>{d.stopPropagation(),P(r,Math.max(0,t))}))})})}B(),document.querySelectorAll(".margin-media iframe").forEach(e=>{const r=e.closest("figure");r&&(e.style.pointerEvents="none",r.style.cursor="pointer",r.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation();const n=e.getAttribute("src"),t=r.querySelector("figcaption")?.textContent||"";if(!i||!p)return;p.innerHTML="";const a=C(n,t);p.appendChild(a),i.hidden=!1,o&&(o.destroy(!0,!0),o=null),o=new Swiper(i.querySelector(".swiper"),{initialSlide:0,loop:!1,slidesPerView:1,keyboard:{enabled:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),L(1),l&&(l.dataset.active="0")}))});const M=Array.from(document.querySelectorAll(".margin-media"));M.forEach(e=>{w(e).forEach((s,n)=>{const t=s.querySelector("img, video");t&&(t.style.cursor="pointer",t.addEventListener("click",a=>{a.stopPropagation(),T(e,n)}))}),e.removeAttribute("tabindex"),e.removeAttribute("role"),e.removeAttribute("aria-label"),e.onkeydown=null,A(e)});let x=null;const q=()=>{x||(x=requestAnimationFrame(()=>{M.forEach(A),x=null}))};window.addEventListener("resize",q,{passive:!0}),window.addEventListener("scroll",q,{passive:!0}),document.querySelectorAll(".margin-media img").forEach(e=>{e.complete||e.addEventListener("load",q,{once:!0})}),f?.addEventListener("click",N),i?.addEventListener("click",e=>{e.target===i&&N()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&!i.hidden&&N()})});
